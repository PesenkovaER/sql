# Лабораторная работа №1  
## Основы работы с SQL-запросами: выборка и модификация данных

**Номер варианта:** 15  

---
# Цель работы

Научиться писать запросы SELECT для аналитики и выполнять CRUD операции в локальной базе данных PostgreSQL.

# Задания

## Задание 1.1  
Вывести дилеров (dealerships) без даты закрытия.  
Сортировка: дата открытия.

Скриншот выполнения SELECT (из основной БД)
<img width="849" height="542" alt="image" src="https://github.com/user-attachments/assets/ef3b5388-b35e-4b42-a2d0-7247216adb00" />

---

## Задание 1.2  
Вывести письма (emails), где тема содержит слово 'Save' или 'Sale'.

**Изменения:**  
Было добавлено дополнительное условие отбора только кликнутых писем (`clicked = 't'`),  
так как без данного условия запрос возвращал более 70 000 строк, что делало результат слишком объёмным и неинформативным.

Скриншот выполнения SELECT (из основной БД)
<img width="1110" height="571" alt="image" src="https://github.com/user-attachments/assets/52e31865-f0f2-47f5-9dc8-c04d01a682f1" />

---

## Задание 1.3  
Создать таблицу `vip_clients` (клиенты с продажами > 50000).  
Добавить `status = 'Gold'`.  
Удалить канал `'phone'`.

**Изменения:**  
В исходном задании требовалось удалить канал `'phone'`,  
однако в используемой базе данных данный канал отсутствует.  
Поэтому вместо него был использен канал `'internet'`, который присутствует в таблице `sales`.

Скриншот подтверждения CRUD (итоговая выборка из локальной таблицы `vip_clients` после всех изменений)
<img width="774" height="871" alt="image" src="https://github.com/user-attachments/assets/abe0338b-9928-4c72-b03f-157debeb64fd" />

---

# Вывод

В ходе выполнения лабораторной работы были выполнены SELECT-запросы с условиями фильтрации и сортировкой, а также реализованы CRUD-операции (создание таблицы, добавление столбца, обновление и удаление данных).

Были внесены обоснованные корректировки в задания с учётом особенностей используемой базы данных.  
Все операции выполнены корректно, результат подтверждён скриншотами.

Файл [lab_01.sql](lab_01.sql) содержит чистый код выполненных запросов.

# Лабораторная работа №2  
## Использование соединений (JOIN), подзапросов и функций преобразования данных

**Номер варианта:** 15  

---
# Цель работы

Освоить методы объединения таблиц (JOIN, UNION), работу с подзапросами и функции преобразования данных (CASE, COALESCE) в PostgreSQL.

# Задания

## Задание 1. Использование JOIN  
Вывести все продажи (модель, цена), совершенные через интернет (`channel = 'internet'`).

Скриншот выполнения SELECT (JOIN, основная БД)

<img width="628" height="611" alt="image" src="https://github.com/user-attachments/assets/6c2c08b3-272f-4000-8ddb-46fee59145e9" />

---

## Задание 2. Использование UNION ALL  
Объединить (UNION ALL) список `dealership_id` из таблицы `sales` и из таблицы `dealerships`.

Скриншот выполнения SELECT (UNION ALL, основная БД)

<img width="381" height="608" alt="image" src="https://github.com/user-attachments/assets/dcdad147-f793-4c96-9119-de2636105dac" />

---

## Задание 3. Преобразование данных (CASE)  
Классифицировать продажи по сумме:  
- `< 1000` — `'Small'`  
- `1000–10000` — `'Medium'`  
- `> 10000` — `'Large'`
Скриншот выполнения SELECT (CASE, основная БД)

<img width="472" height="790" alt="image" src="https://github.com/user-attachments/assets/9ddb3e72-ae5a-403a-aa25-438559122b63" />

---

# Вывод

В ходе лабораторной работы были:

- выполнены запросы с использованием `JOIN` для объединения таблиц;
- применён оператор `UNION ALL` для объединения данных из разных источников;
- использована конструкция `CASE` для классификации данных по заданным условиям.

Все задания выполнены в соответствии с вариантом.  
Файл [lab_02.sql](lab_02.sql) содержит чистый код выполненных запросов.

# Лабораторная работа №3  
## Агрегации и аналитические функции.

**Номер варианта:** 15  

---

# Цель работы

Научиться выполнять быстрый и эффективный анализ данных, используя возможности агрегирования SQL.  
Освоить синтаксис группировки данных, фильтрации групп и вычисления статистических показателей.

---

# Задачи

- Изучить теоретические основы агрегации данных (`COUNT`, `SUM`, `AVG`, `MIN`, `MAX`, `STDDEV`).
- Разобрать принципы работы предложения `GROUP BY` для разделения данных на логические группы.
- Научиться фильтровать агрегированные данные с помощью предложения `HAVING`.
- Применить полученные знания для анализа качества данных (поиск пропусков, дубликатов).
- Выполнить индивидуальное задание (3 запроса) согласно варианту.

---

# Индивидуальные задания

## Задание 1  
Найти количество клиентов из штата `'CA'`.

Скриншот выполнения запроса (COUNT)

<img width="218" height="98" alt="image" src="https://github.com/user-attachments/assets/0191dc6f-f2cc-433f-974a-c5bd26955146" />

---

## Задание 2  
Вывести количество продаж по годам (используя функцию `EXTRACT`).

Скриншот выполнения запроса (GROUP BY + EXTRACT)

<img width="274" height="374" alt="image" src="https://github.com/user-attachments/assets/f0c59670-a33b-4970-877d-fa747c77101e" />

---

## Задание 3  
Вывести категории товаров, в которых представлено более 5 моделей.

Скриншот выполнения запроса (GROUP BY + HAVING)

<img width="319" height="95" alt="image" src="https://github.com/user-attachments/assets/35f4fe42-8fd6-4aee-b919-b92174edc230" />

---

# Вывод

В ходе выполнения лабораторной работы были освоены и применены агрегатные функции SQL (`COUNT`), а также механизмы группировки данных (`GROUP BY`) и фильтрации групп (`HAVING`).  

Была выполнена агрегация данных по различным признакам:  
- подсчёт количества клиентов по условию,  
- анализ продаж по годам с использованием функции `EXTRACT`,  
- определение категорий товаров с количеством моделей выше заданного порога.  

Полученные результаты подтверждают корректное использование инструментов агрегирования и позволяют эффективно анализировать данные базы.
Файл [lab_03.sql](lab_03.sql) содержит чистый код выполненных запросов.
